<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=None">
  <style type="text/css">
td.linenos { background-color: #f0f0f0; padding-right: 10px; }
span.lineno { background-color: #f0f0f0; padding: 0 5px 0 5px; }
pre { line-height: 125%; }
body .hll { background-color: #49483e }
body  { background: #272822; color: #f8f8f2 }
body .c { color: #75715e } /* Comment */
body .err { color: #960050; background-color: #1e0010 } /* Error */
body .k { color: #66d9ef } /* Keyword */
body .l { color: #ae81ff } /* Literal */
body .n { color: #f8f8f2 } /* Name */
body .o { color: #f92672 } /* Operator */
body .p { color: #f8f8f2 } /* Punctuation */
body .cm { color: #75715e } /* Comment.Multiline */
body .cp { color: #75715e } /* Comment.Preproc */
body .c1 { color: #75715e } /* Comment.Single */
body .cs { color: #75715e } /* Comment.Special */
body .ge { font-style: italic } /* Generic.Emph */
body .gs { font-weight: bold } /* Generic.Strong */
body .kc { color: #66d9ef } /* Keyword.Constant */
body .kd { color: #66d9ef } /* Keyword.Declaration */
body .kn { color: #f92672 } /* Keyword.Namespace */
body .kp { color: #66d9ef } /* Keyword.Pseudo */
body .kr { color: #66d9ef } /* Keyword.Reserved */
body .kt { color: #66d9ef } /* Keyword.Type */
body .ld { color: #e6db74 } /* Literal.Date */
body .m { color: #ae81ff } /* Literal.Number */
body .s { color: #e6db74 } /* Literal.String */
body .na { color: #a6e22e } /* Name.Attribute */
body .nb { color: #f8f8f2 } /* Name.Builtin */
body .nc { color: #a6e22e } /* Name.Class */
body .no { color: #66d9ef } /* Name.Constant */
body .nd { color: #a6e22e } /* Name.Decorator */
body .ni { color: #f8f8f2 } /* Name.Entity */
body .ne { color: #a6e22e } /* Name.Exception */
body .nf { color: #a6e22e } /* Name.Function */
body .nl { color: #f8f8f2 } /* Name.Label */
body .nn { color: #f8f8f2 } /* Name.Namespace */
body .nx { color: #a6e22e } /* Name.Other */
body .py { color: #f8f8f2 } /* Name.Property */
body .nt { color: #f92672 } /* Name.Tag */
body .nv { color: #f8f8f2 } /* Name.Variable */
body .ow { color: #f92672 } /* Operator.Word */
body .w { color: #f8f8f2 } /* Text.Whitespace */
body .mf { color: #ae81ff } /* Literal.Number.Float */
body .mh { color: #ae81ff } /* Literal.Number.Hex */
body .mi { color: #ae81ff } /* Literal.Number.Integer */
body .mo { color: #ae81ff } /* Literal.Number.Oct */
body .sb { color: #e6db74 } /* Literal.String.Backtick */
body .sc { color: #e6db74 } /* Literal.String.Char */
body .sd { color: #e6db74 } /* Literal.String.Doc */
body .s2 { color: #e6db74 } /* Literal.String.Double */
body .se { color: #ae81ff } /* Literal.String.Escape */
body .sh { color: #e6db74 } /* Literal.String.Heredoc */
body .si { color: #e6db74 } /* Literal.String.Interpol */
body .sx { color: #e6db74 } /* Literal.String.Other */
body .sr { color: #e6db74 } /* Literal.String.Regex */
body .s1 { color: #e6db74 } /* Literal.String.Single */
body .ss { color: #e6db74 } /* Literal.String.Symbol */
body .bp { color: #f8f8f2 } /* Name.Builtin.Pseudo */
body .vc { color: #f8f8f2 } /* Name.Variable.Class */
body .vg { color: #f8f8f2 } /* Name.Variable.Global */
body .vi { color: #f8f8f2 } /* Name.Variable.Instance */
body .il { color: #ae81ff } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span style="background-color: #272822; padding: 0 5px 0 5px">  1</span> <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  2</span> <span style="color: #75715e"># File Name: mySimplex.py                                                  #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  3</span> <span style="color: #75715e"># Author: Geonsik Yu, Purdue University, IE Dept                           #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  4</span> <span style="color: #75715e">#                                                                          #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  5</span> <span style="color: #75715e"># - Implement simplex method with the following requirements satisfied:    #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  6</span> <span style="color: #75715e">#                                                                          #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  7</span> <span style="color: #75715e"># Programming Requirements:                                                #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  8</span> <span style="color: #75715e"># (R1) Design a routine to do the conversion to the standard form LP.      #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">  9</span> <span style="color: #75715e"># (R2) Design a routine to detect if the LP at hand is feasible or not.    #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 10</span> <span style="color: #75715e">#      (15 pt)                                                             #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 11</span> <span style="color: #75715e"># (R3) Design a routine to detect if the coefficient matrix associated with#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 12</span> <span style="color: #75715e">#    the standard form of the LP has full row rank; and if not, how to     #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 13</span> <span style="color: #75715e">#    remove the redundant constraints. (15 pt)                             #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 14</span> <span style="color: #75715e"># (R4) Design a routine to check if a basic feasible solution (BFS) with   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 15</span> <span style="color: #75715e">#     the identity matrix as the corresponding basis is readily available. #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 16</span> <span style="color: #75715e">#     If yes, you can just go ahead to use the BFS to start your simplex   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 17</span> <span style="color: #75715e">#     method;                                                              #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 18</span> <span style="color: #75715e">#     otherwise, use the methods we learned in class to start your simplex #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 19</span> <span style="color: #75715e">#     with an identity matrix as the initial basis. (15 pt)                #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 20</span> <span style="color: #75715e"># (R5) Your code needs to implement one rule to prevent the simplex method #  </span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 21</span> <span style="color: #75715e">#     from cycling. (15 pt)                                                #        </span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 22</span> <span style="color: #75715e"># (R6) Termination: your code needs to be able to handle both cases at     #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 23</span> <span style="color: #75715e">#     termination (6-1) a finite optimal solution or (6-2) unbounded(15 pt)#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 24</span> <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 25</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 26</span> <span style="color: #f92672">from</span> <span style="color: #f8f8f2">builtins</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">object</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 27</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">numpy</span> <span style="color: #f92672">as</span> <span style="color: #f8f8f2">np</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 28</span> <span style="color: #f92672">from</span> <span style="color: #f8f8f2">numpy</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">dot,</span> <span style="color: #f8f8f2">zeros</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 29</span> <span style="color: #f92672">from</span> <span style="color: #f8f8f2">numpy.linalg</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">matrix_rank,</span> <span style="color: #f8f8f2">norm</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 30</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">sys</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 31</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 32</span> <span style="color: #75715e">### Numpy printing parameters setting.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 33</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_printoptions(precision</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">4</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">linewidth</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">200</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">threshold</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">sys</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">maxsize)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 34</span> <span style="color: #75715e">### Global threshold value for checking zero value with floating point errors.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 35</span> <span style="color: #f8f8f2">THRESHOLD</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1e-8</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 36</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 37</span> <span style="color: #66d9ef">class</span> <span style="color: #a6e22e">SimplexProblem</span><span style="color: #f8f8f2">(object):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 38</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">__init__</span><span style="color: #f8f8f2">(self):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 39</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 40</span>         <span style="color: #75715e"># Constructor: This function constructs an LP problem object               #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 41</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 42</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 43</span>         <span style="color: #75715e">## Attribute that will be initialized by setObjectiveDirection() function.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 44</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objDirection</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>     <span style="color: #75715e"># Decides whether the given problem is maximization or minimization.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 45</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objectiveValue</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 46</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 47</span>         <span style="color: #75715e">## Attributes that will be initialized by setVariables() function.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 48</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objCoeffs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>        <span style="color: #75715e"># Coefficient values in the objective function for variables.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 49</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>         <span style="color: #75715e"># Names for variables.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 50</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varLowerbounds</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>   <span style="color: #75715e"># Lowerbounds for variables.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 51</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varCount</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>         <span style="color: #75715e"># Number of non-slack, non-artificial objCoeffs.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 52</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>     <span style="color: #75715e"># Reduced costs</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 53</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 54</span>         <span style="color: #75715e"># Attributes that will be initialized by addConstraint function.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 55</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_conNames</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>         <span style="color: #75715e"># List of names for all the constraints.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 56</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>          <span style="color: #75715e"># Coefficient Matrix &quot;A&quot; </span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 57</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_ineqDirs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>         <span style="color: #75715e"># </span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 58</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 59</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 60</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 61</span>         <span style="color: #75715e"># Attributes for Two step method.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 62</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_twoStep</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">False</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 63</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_2nd_objectiveValue</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 64</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedSecondary</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>   <span style="color: #75715e"># Secondary reduced costs</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 65</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 66</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">debug</span><span style="color: #f8f8f2">(self):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 67</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 68</span>         <span style="color: #75715e"># This debug function prints out internal attributes.                      #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 69</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 70</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;# of original variables: &quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varCount)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 71</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 72</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 73</span>         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_twoStep</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">True:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 74</span>             <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedSecondary)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 75</span>         <span style="color: #f8f8f2">tmp</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">array(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 76</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 77</span>             <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(tmp[idx],</span> <span style="color: #e6db74">&quot;||&quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 78</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Basis: &quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 79</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;---------------------------------------&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 80</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 81</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">setObjectiveDirection</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Max</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 82</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objDirection</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Max</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 83</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 84</span>         <span style="color: #75715e"># This function initializes the direction of optimization: If the problem  #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 85</span>         <span style="color: #75715e"># is on maximization, Max = True (Default), otherwise, Max = False.        #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 86</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 87</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 88</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">setVariables</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Names,</span> <span style="color: #f8f8f2">ObjCoeffs,</span> <span style="color: #f8f8f2">Lowerbounds</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">None):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 89</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 90</span>         <span style="color: #75715e"># This function initializes the decision variable set, their names, their  #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 91</span>         <span style="color: #75715e"># coefficients in the objective function, and their upper &amp; lower bounds.  # </span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 92</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 93</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objCoeffs</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ObjCoeffs</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 94</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Names</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 95</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varLowerbounds</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Lowerbounds</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 96</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px"> 97</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">addConstraint</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Name,</span> <span style="color: #f8f8f2">rowVec,</span> <span style="color: #f8f8f2">ineq_dir,</span> <span style="color: #f8f8f2">RHS):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 98</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px"> 99</span>         <span style="color: #75715e"># This function adds one constraint at a time. Each constraint requires to #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">100</span>         <span style="color: #75715e"># have coefficient vector with the same order with the variable vector, one#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">101</span>         <span style="color: #75715e"># inequality direction, and one right-hand side constant value.            #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">102</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">103</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_conNames</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(Name)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">104</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(rowVec)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">105</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_ineqDirs</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(ineq_dir)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">106</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(RHS)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">107</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">108</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">printCurrentStatus</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Tableau):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">109</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;------------------------------------------------------------------&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">110</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Current Basic Variables: &quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #e6db74">&#39; &#39;</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">join(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet)</span> <span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">111</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Current Objective Value: &quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">repr(Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span> <span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">112</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">113</span>             <span style="color: #f8f8f2">value</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0.0</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">114</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames[idx]</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">115</span>                 <span style="color: #f8f8f2">value</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Tableau[</span><span style="color: #ae81ff">1</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">index(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames[idx]),</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">116</span>             <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames[idx],</span> <span style="color: #e6db74">&quot; := &quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">repr(value))</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">117</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">118</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">setup</span><span style="color: #f8f8f2">(self):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">119</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">120</span>         <span style="color: #75715e"># Related to the requirement (R1).                                         #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">121</span>         <span style="color: #75715e"># (1) Transform the objective direction into &quot;Minimization&quot; and            #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">122</span>         <span style="color: #75715e">#     negate the signs of objective coefficients.                          #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">123</span>         <span style="color: #75715e"># (2) Transform the input constraint:                                      #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">124</span>         <span style="color: #75715e">#     2-1) [LHS &lt;= RHS form]: pass.                                        #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">125</span>         <span style="color: #75715e">#     2-2) [LHS &gt;= RHS form]: change to [-LHS &lt;= -RHS].                    #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">126</span>         <span style="color: #75715e">#     2-3) [LHS = RHS form]: split into [LHS &lt;= RHS form]                  #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">127</span>         <span style="color: #75715e">#                                   and [-LHS &lt;= -RHS form].               #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">128</span>         <span style="color: #75715e"># (3) Check the resulting RHS&#39;s from (2).                                  #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">129</span>         <span style="color: #75715e">#     IF all the RHS&#39;s are positive:                                       #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">130</span>         <span style="color: #75715e">#          Go add (+1 coeff) slack variables for each constraints.         #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">131</span>         <span style="color: #75715e">#          Check the problem type as &quot;COMMON&quot;.                             #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">132</span>         <span style="color: #75715e">#          Check the problem feasibility as &quot;FEASIBLE&quot;                     #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">133</span>         <span style="color: #75715e">#     Else:                                                                #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">134</span>         <span style="color: #75715e">#          Go add (+1 coeff) slack variables for constraints with positive #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">135</span>         <span style="color: #75715e">#             RHS&#39;s (name S_i),                                            #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">136</span>         <span style="color: #75715e">#             add (-1 coeff) slack variables for constraints with negative #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">137</span>         <span style="color: #75715e">#             RHS&#39;s (name S_i), and                                        #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">138</span>         <span style="color: #75715e">#             add (+1 coeff) artificial variables for constraints with     #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">139</span>         <span style="color: #75715e">#             negative RHS&#39;s (name A_i).                                   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">140</span>         <span style="color: #75715e">#          Check the problem type as &quot;TWOSTEP&quot;.                            # </span>
<span style="background-color: #272822; padding: 0 5px 0 5px">141</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">142</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varCount</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">143</span>         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objDirection</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">True:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">144</span>             <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objCoeffs</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">145</span>         <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">146</span>             <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">ele</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">ele</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_objCoeffs]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">147</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">148</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_conNames)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">149</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_ineqDirs[idx]</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;G&#39;</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">150</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[idx]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">ele</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">ele</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[idx]]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">151</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx]</span> <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">152</span>             <span style="color: #66d9ef">elif</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_ineqDirs[idx]</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;E&#39;</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">153</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span> <span style="color: #f8f8f2">[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">ele</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">ele</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[idx]]</span> <span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">154</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx]</span> <span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">155</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">156</span>         <span style="color: #f8f8f2">s_ind,</span> <span style="color: #f8f8f2">a_ind</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">1</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">157</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">158</span>             <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #e6db74">&quot;S&quot;</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">repr(s_ind))</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">159</span>             <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">160</span>             <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">jdx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">161</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">jdx</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">idx:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">162</span>                     <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[jdx]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #f92672">+</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">163</span>                 <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">164</span>                     <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[jdx]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">165</span>             <span style="color: #f8f8f2">s_ind</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span>         
<span style="background-color: #272822; padding: 0 5px 0 5px">166</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">167</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">168</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx]</span> <span style="color: #f92672">&lt;</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">169</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #e6db74">&quot;A&quot;</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">repr(a_ind))</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">170</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">171</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[idx]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">ele</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">ele</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[idx]]</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">172</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx]</span> <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">173</span>                 <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">jdx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">174</span>                     <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">jdx</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">idx:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">175</span>                         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[jdx]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #f92672">+</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">176</span>                     <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">177</span>                         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[jdx]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>                
<span style="background-color: #272822; padding: 0 5px 0 5px">178</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #e6db74">&quot;A&quot;</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">repr(a_ind))</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">179</span>                 <span style="color: #f8f8f2">a_ind</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span>         
<span style="background-color: #272822; padding: 0 5px 0 5px">180</span>             <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">181</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames[self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varCount</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">idx])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">182</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">183</span>         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">a_ind</span> <span style="color: #f92672">&lt;</span> <span style="color: #ae81ff">1.0001</span><span style="color: #f8f8f2">:</span> <span style="color: #75715e">## &quot;COMMON&quot; case.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">184</span>             <span style="color: #f8f8f2">returnStr</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;COMMON&quot;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">185</span>         <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span> <span style="color: #75715e">## &quot;TWOSTEP&quot; case.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">186</span>             <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_twoStep</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">187</span>             <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">name</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">188</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">name[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&quot;A&quot;</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">189</span>                     <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedSecondary</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">190</span>                 <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">191</span>                     <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedSecondary</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">192</span>             <span style="color: #f8f8f2">returnStr</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;TWOSTEP&quot;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">193</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">returnStr</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">194</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">195</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">buildTableau</span><span style="color: #f8f8f2">(self):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">196</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">197</span>         <span style="color: #75715e"># This function builds tableau for both &quot;COMMON&quot; and &quot;TWOSTEP&quot; cases       #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">198</span>         <span style="color: #75715e"># and reduce the constraints (non-zeroth rows of the tableau) using the    #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">199</span>         <span style="color: #75715e"># reduced row echelon form.                                                #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">200</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">201</span>         <span style="color: #f8f8f2">Tableau</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">202</span>         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_twoStep</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">True:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">203</span>             <span style="color: #f8f8f2">Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedSecondary</span> <span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">204</span>         <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">205</span>             <span style="color: #f8f8f2">Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts</span> <span style="color: #f8f8f2">)</span>            
<span style="background-color: #272822; padding: 0 5px 0 5px">206</span>         <span style="color: #f8f8f2">Tableau[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span> <span style="color: #ae81ff">0</span> <span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">207</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">208</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">209</span>             <span style="color: #f8f8f2">Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_AMatrix[idx]</span> <span style="color: #f8f8f2">)</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">210</span>             <span style="color: #f8f8f2">Tableau[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_RHSs[idx]</span> <span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">211</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">212</span>         <span style="color: #f8f8f2">Tableau</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">array(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">213</span>         <span style="color: #75715e">#Tableau[1:,], tempIndices = self.reduceProblemMatrix(Tableau[1:,])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">214</span>         <span style="color: #f8f8f2">tempConMat,</span> <span style="color: #f8f8f2">tempIndices</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">reduceProblemMatrix(Tableau[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">:,])</span>        
<span style="background-color: #272822; padding: 0 5px 0 5px">215</span>         <span style="color: #f8f8f2">tempConMat</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">vstack([Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,:],</span> <span style="color: #f8f8f2">tempConMat])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">216</span>         <span style="color: #f8f8f2">Tableau</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">tempConMat</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">217</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">218</span>         <span style="color: #75715e">## Reorder basis based on the indices from the reducedProblemMatrix</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">219</span>         <span style="color: #f8f8f2">tempList</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet[i]</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">tempIndices]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">220</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">tempList</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">221</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">222</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Initialize the given LP problem:&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">223</span>         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_twoStep:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">224</span>             <span style="color: #f8f8f2">Tableau</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">initZeroth(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">225</span>             <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;TWO STEP METHOD CALLED:&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">226</span>         <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">227</span>             <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;VANILLA SIMPLEX METHOD CALLED:&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">228</span>         
<span style="background-color: #272822; padding: 0 5px 0 5px">229</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">printCurrentStatus(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">230</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">Tableau</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">231</span>     
<span style="background-color: #272822; padding: 0 5px 0 5px">232</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">initZeroth</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Tableau):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">233</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">234</span>         <span style="color: #75715e"># This function initializes the 0th row of the tableau for basic columns.  #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">235</span>         <span style="color: #75715e"># It assumes that for the input tableau&#39;s basic columns, they are all one- #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">236</span>         <span style="color: #75715e"># hot vectors except for the zero-th element. This function simply finds   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">237</span>         <span style="color: #75715e"># basic columns with -1 for the zero-th element, and add pivot rows to the #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">238</span>         <span style="color: #75715e"># zero-th row.                                                             #     </span>
<span style="background-color: #272822; padding: 0 5px 0 5px">239</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">240</span>         <span style="color: #f8f8f2">colIndices</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">241</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">242</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">idx]</span> <span style="color: #f92672">!=</span> <span style="color: #ae81ff">0</span> <span style="color: #f92672">and</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames[idx]</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">243</span>                 <span style="color: #f8f8f2">colIndices</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(idx)</span>                
<span style="background-color: #272822; padding: 0 5px 0 5px">244</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">colIndices:</span>           
<span style="background-color: #272822; padding: 0 5px 0 5px">245</span>             <span style="color: #f8f8f2">rowIdx</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">argmax(Tableau[:,</span> <span style="color: #f8f8f2">idx])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">246</span>             <span style="color: #f8f8f2">ratio</span> <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">idx]</span><span style="color: #f92672">/</span><span style="color: #f8f8f2">Tableau[rowIdx,</span> <span style="color: #f8f8f2">idx]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">247</span>             <span style="color: #f8f8f2">Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">:]</span> <span style="color: #f92672">+=</span> <span style="color: #f8f8f2">ratio</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">Tableau[rowIdx,</span> <span style="color: #f8f8f2">:]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">248</span>         
<span style="background-color: #272822; padding: 0 5px 0 5px">249</span>         <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Initialize the zero-th row:&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">250</span>         <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">printCurrentStatus(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">251</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">Tableau</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">252</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">253</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">solve</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Tableau):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">254</span>         <span style="color: #75715e"># Related to the requirement (R2).</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">255</span>         <span style="color: #75715e"># Related to the requirement (R4).</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">256</span>         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_twoStep</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">True:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">257</span>             <span style="color: #75715e">## IF the problem type is &quot;TWOSTEP&quot;:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">258</span>             <span style="color: #75715e">#     (a) Put a secondary objective function with (+1 coeff) for all artificial variables.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">259</span>             <span style="color: #75715e">#     (b) Run tableau simplex steps until it meets one of the [Tableau Simplex&#39;s Termination Conditions]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">260</span>             <span style="color: #75715e">#     (c) IF the optimal objective value from (b) is zero with all zero artificial values, then process to the 2nd step</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">261</span>             <span style="color: #75715e">#         Otherwise, end procedure and say the original LP is not feasible.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">262</span>             <span style="color: #f8f8f2">terminationFlag</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">263</span>             <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Run the 1st step of Two Step Method&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">264</span>             <span style="color: #66d9ef">while</span><span style="color: #f8f8f2">(terminationFlag</span> <span style="color: #f92672">==</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">265</span>                 <span style="color: #f8f8f2">Tableau,</span> <span style="color: #f8f8f2">terminationFlag</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_oneIteration(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">266</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">printCurrentStatus(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">267</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">THRESHOLD:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">268</span>                 <span style="color: #75715e">## When 1st phase of Two step method ends with feasibility gueranteed.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">269</span>                 <span style="color: #75715e">## (1) Setup 2nd phase tableau.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">270</span>                 <span style="color: #f8f8f2">removalIndices</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">index(ele)</span> <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">ele</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames</span> <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">ele[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">==</span><span style="color: #e6db74">&quot;A&quot;</span><span style="color: #f8f8f2">]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">271</span>                 <span style="color: #f8f8f2">Tableau</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">delete(Tableau,</span> <span style="color: #f8f8f2">removalIndices,</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">272</span>                 <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">273</span>                     <span style="color: #f8f8f2">Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,idx]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_reducedCosts[idx]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">274</span>                 <span style="color: #f8f8f2">Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">275</span>                 <span style="color: #75715e">## (2) Restore 0 reduced costs for the basic columns.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">276</span>                 <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;Run the Vanilla Simplex Method or the 2st step of Two Step Method&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">277</span>                 <span style="color: #f8f8f2">Tableau</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">initZeroth(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">278</span>                 <span style="color: #f8f8f2">terminationFlag</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">279</span>                 <span style="color: #66d9ef">while</span><span style="color: #f8f8f2">(terminationFlag</span> <span style="color: #f92672">==</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">280</span>                     <span style="color: #f8f8f2">Tableau,</span> <span style="color: #f8f8f2">terminationFlag</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_oneIteration(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">281</span>                     <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">printCurrentStatus(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">282</span>             <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">283</span>                 <span style="color: #75715e">## When 1st phase of Two step method ends otherwise.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">284</span>                 <span style="color: #75715e"># [Tableau Simplex&#39;s Termination Conditions]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">285</span>                 <span style="color: #75715e"># (T0) When 1st phase of Two step method ends otherwise.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">286</span>                 <span style="color: #75715e">#    - &quot;No feasible solution&quot;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">287</span>                 <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;- Terminate Procedure: No feasible solution for this problem.&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">288</span>         <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">289</span>             <span style="color: #75715e">## IF the problem type is &quot;COMMON&quot;:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">290</span>             <span style="color: #75715e">## Run tableau simplex steps until it meets one of the [Tableau Simplex&#39;s Termination Conditions]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">291</span>             <span style="color: #66d9ef">while</span><span style="color: #f8f8f2">(terminationFlag</span> <span style="color: #f92672">==</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">292</span>                 <span style="color: #f8f8f2">Tableau,</span> <span style="color: #f8f8f2">terminationFlag</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">run_oneIteration(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">293</span>                 <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">printCurrentStatus(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">294</span>             <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">printCurrentStatus(Tableau)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">295</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">Tableau</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">296</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">297</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">run_oneIteration</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Tableau):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">298</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">299</span>         <span style="color: #75715e"># (1) Find a positive zeroth row element in the tableau with smallest index#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">300</span>         <span style="color: #75715e">#     value. Set the corresponding variable as &quot;Entering Variable&quot; in      #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">301</span>         <span style="color: #75715e">#     this iteration.                                                      #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">302</span>         <span style="color: #75715e">#     If there is no such element in the zeroth row, then terminate the    #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">303</span>         <span style="color: #75715e">#     iteration.                                                           #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">304</span>         <span style="color: #75715e">#     If there is no such element that (2) can find an element, then       #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">305</span>         <span style="color: #75715e">#     terminate the iteration.                                             #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">306</span>         <span style="color: #75715e"># (2) Find a non-negative element from the selected column with the minimun#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">307</span>         <span style="color: #75715e">#     ratio (rhs/ele). Set the corresponding variable as &quot;Leaving Variable&quot;#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">308</span>         <span style="color: #75715e">#     in this iteration.                                                   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">309</span>         <span style="color: #75715e">#     If there exists a tie, then select the one with the smaller index.   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">310</span>         <span style="color: #75715e">#     If there is no such element in the column, go to (1) and find another#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">311</span>         <span style="color: #75715e">#     column.                                                              #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">312</span>         <span style="color: #75715e"># (3) Multiply the pivot row by ratios (-Ele/pivotEle) and add it to the   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">313</span>         <span style="color: #75715e">#     corresponding rows, respectively.                                    #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">314</span>         <span style="color: #75715e">#                                                                          #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">315</span>         <span style="color: #75715e"># Related to the requirement (R6)                                          #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">316</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">317</span>         <span style="color: #f8f8f2">terminationType</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span> <span style="color: #75715e"># 0 - No termination</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">318</span>                             <span style="color: #75715e"># 1 - Termination with optimal corner.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">319</span>                             <span style="color: #75715e"># 2 - Termination with unboundedness.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">320</span>         <span style="color: #f8f8f2">pivotCol</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">321</span>         <span style="color: #f8f8f2">pivotRow</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">322</span>         <span style="color: #f8f8f2">failCol</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">323</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">324</span>         <span style="color: #f8f8f2">Once</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">False</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">325</span>         <span style="color: #f8f8f2">pivotCol</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">findCol(Tableau,</span> <span style="color: #f8f8f2">failCol)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">326</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">327</span>         <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">pivotCol</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">None:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">328</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">Once</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">False:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">329</span>                 <span style="color: #75715e"># [Tableau Simplex&#39;s Termination Conditions]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">330</span>                 <span style="color: #75715e"># (T1) If all the reduced costs are negative.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">331</span>                 <span style="color: #75715e">#    - &quot;Optimal corner point found&quot;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">332</span>                 <span style="color: #75715e">#    - Return the optimal solution and the optimal objective value.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">333</span>                 <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;- Terminate Procedure: Optimal Value = &quot;</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">334</span>                 <span style="color: #f8f8f2">terminationType</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">335</span>             <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">336</span>                 <span style="color: #75715e"># [Tableau Simplex&#39;s Termination Conditions]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">337</span>                 <span style="color: #75715e"># (T2) If for all positive reduced cost columns, there are only non-positive elememts.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">338</span>                 <span style="color: #75715e">#    - &quot;Unboundedness found&quot;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">339</span>                 <span style="color: #75715e">#    - Return &quot;-inf&quot; for minimization problems and &quot;+inf&quot; for maximization problems.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">340</span>                 <span style="color: #66d9ef">print</span><span style="color: #f8f8f2">(</span><span style="color: #e6db74">&quot;- Terminate Procedure: Unboundedness&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">341</span>                 <span style="color: #f8f8f2">terminationType</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">2</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">342</span>         <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">343</span>             <span style="color: #f8f8f2">Once</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">344</span>             <span style="color: #f8f8f2">pivotRow</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">findRow(Tableau[:,</span> <span style="color: #f8f8f2">pivotCol],</span> <span style="color: #f8f8f2">Tableau[:,</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">345</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">pivotRow</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">None:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">346</span>                 <span style="color: #f8f8f2">failCol</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(pivotCol)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">347</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">348</span>             <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_basisSet[pivotRow</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">_varNames[pivotCol]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">349</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">350</span>             <span style="color: #f8f8f2">Tableau[pivotRow,</span> <span style="color: #f8f8f2">:]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Tableau[pivotRow,</span> <span style="color: #f8f8f2">:]</span> <span style="color: #f92672">/</span> <span style="color: #f8f8f2">Tableau[pivotRow,</span> <span style="color: #f8f8f2">pivotCol]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">351</span>             
<span style="background-color: #272822; padding: 0 5px 0 5px">352</span>             <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">353</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">!=</span> <span style="color: #f8f8f2">pivotRow:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">354</span>                     <span style="color: #f8f8f2">ratio</span> <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">Tableau[idx,</span> <span style="color: #f8f8f2">pivotCol]</span><span style="color: #f92672">/</span><span style="color: #f8f8f2">Tableau[pivotRow,</span> <span style="color: #f8f8f2">pivotCol];</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">355</span>                     <span style="color: #f8f8f2">Tableau[idx,</span> <span style="color: #f8f8f2">:]</span> <span style="color: #f92672">+=</span> <span style="color: #f8f8f2">ratio</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">Tableau[pivotRow,</span> <span style="color: #f8f8f2">:]</span>           
<span style="background-color: #272822; padding: 0 5px 0 5px">356</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">(Tableau,</span> <span style="color: #f8f8f2">terminationType)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">357</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">358</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">findCol</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">Tableau,</span> <span style="color: #f8f8f2">failCol):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">359</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">360</span>         <span style="color: #75715e"># This function returns the pivot column for simplex iteration.            #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">361</span>         <span style="color: #75715e"># Check the non-optimality condition from the last column because we always#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">362</span>         <span style="color: #75715e"># want to remove the artificial column first for the TWOSTEP level.        #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">363</span>         <span style="color: #75715e"># To achieve consistency in terms of the Blend&#39;s rule, we choose the       #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">364</span>         <span style="color: #75715e"># HIGHEST-numbered nonbasic column with a negative (reduced) cost.         #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">365</span>         <span style="color: #75715e"># Related to the requirement (R5): Blends&#39; rule.                           #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">366</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">367</span>         <span style="color: #f8f8f2">pivotCol</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">368</span>         <span style="color: #75715e">#for idx in range(Tableau.shape[1]-1):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">369</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">reversed(range(Tableau</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">370</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(Tableau[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">idx]</span> <span style="color: #f92672">&gt;</span> <span style="color: #f8f8f2">THRESHOLD</span> <span style="color: #f92672">and</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">not</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">failCol):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">371</span>                 <span style="color: #f8f8f2">pivotCol</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">idx</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">372</span>                 <span style="color: #66d9ef">break</span><span style="color: #f8f8f2">;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">373</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">pivotCol</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">374</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">375</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">findRow</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">PivotCol,</span> <span style="color: #f8f8f2">RHSs):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">376</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">377</span>         <span style="color: #75715e"># This function returns the pivot row when pivot column is given in simplex#</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">378</span>         <span style="color: #75715e"># We choose the row with the lowest ratio between the (transformed) right  #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">379</span>         <span style="color: #75715e"># hand side and the coefficient in the pivot tableau where the coefficient #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">380</span>         <span style="color: #75715e"># is greater than zero.                                                    #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">381</span>         <span style="color: #75715e"># To achive consistency in terms of the blend&#39;s rule, when the minimum     #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">382</span>         <span style="color: #75715e"># ratio is shared by several rows, we choose the row with HIGHEST index.   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">383</span>         <span style="color: #75715e"># Related to the requirement (R5): Blends&#39; rule.                           #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">384</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">385</span>         <span style="color: #f8f8f2">pivotRow</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">None</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">386</span>         <span style="color: #f8f8f2">minRatio</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">float(</span><span style="color: #e6db74">&quot;Inf&quot;</span><span style="color: #f8f8f2">)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">387</span>         <span style="color: #75715e">#for idx in reversed(range(1, PivotCol.size)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">388</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">PivotCol</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">size):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">389</span>             <span style="color: #75715e">## Selects larger index when it falls in tie situation.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">390</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">PivotCol[idx]</span> <span style="color: #f92672">&gt;</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">391</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">RHSs[idx]</span><span style="color: #f92672">/</span><span style="color: #f8f8f2">PivotCol[idx]</span> <span style="color: #f92672">&lt;=</span> <span style="color: #f8f8f2">minRatio:</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">392</span>                     <span style="color: #f8f8f2">minRatio</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">RHSs[idx]</span><span style="color: #f92672">/</span><span style="color: #f8f8f2">PivotCol[idx]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">393</span>                     <span style="color: #f8f8f2">pivotRow</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">idx</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">394</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">pivotRow</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">395</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">396</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">397</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">reduceProblemMatrix</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">ProblemMatrix):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">398</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">399</span>         <span style="color: #75715e"># This function returns the problem matrix [A;b] after removing row vector #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">400</span>         <span style="color: #75715e"># redundancy.                                                              #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">401</span>         <span style="color: #75715e"># Related to the requirement (R3).                                         #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">402</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">403</span>         <span style="color: #f8f8f2">rref_results</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">self</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">rref(ProblemMatrix)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">404</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">405</span>         <span style="color: #f8f8f2">rowFlags</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[False]</span><span style="color: #f92672">*</span><span style="color: #f8f8f2">rref_results[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">406</span>         <span style="color: #75715e"># Check each rref matrix&#39;s row whether there is non-zero element and make a T/F flag array for it.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">407</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(rref_results[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">408</span>             <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">j</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(rref_results[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">409</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">abs(rref_results[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">][i][j])</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">THRESHOLD:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">410</span>                     <span style="color: #f8f8f2">rowFlags[i]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">411</span>                     <span style="color: #66d9ef">break</span><span style="color: #f8f8f2">;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">412</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">413</span>         <span style="color: #f8f8f2">remainderIndices</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">414</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">idx</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(len(rowFlags)):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">415</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">rowFlags[idx]</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">False:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">416</span>                 <span style="color: #66d9ef">break</span><span style="color: #f8f8f2">;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">417</span>             <span style="color: #f8f8f2">remainderIndices</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append(rref_results[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">][idx])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">418</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">(ProblemMatrix[remainderIndices,:],</span> <span style="color: #f8f8f2">remainderIndices)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">419</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">420</span>     <span style="color: #66d9ef">def</span> <span style="color: #a6e22e">rref</span><span style="color: #f8f8f2">(self,</span> <span style="color: #f8f8f2">ProblemMatrix):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">421</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">422</span>         <span style="color: #75715e"># This function returns (1) the reduced row echelon form (RREF) of the     #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">423</span>         <span style="color: #75715e"># problem matrix and (2) the list of original row indices from the input   #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">424</span>         <span style="color: #75715e"># matrix of each row of RREF. * ProblemMatrix = [A; b]                     #                        #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">425</span>         <span style="color: #75715e"># Reference Source:                                                        #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">426</span>         <span style="color: #75715e"># https://stackoverflow.com/questions/7664246/python-built-in-function-to- #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">427</span>         <span style="color: #75715e">#  do-matrix-reduction/7665269#7665269                                     #</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">428</span>         <span style="color: #75715e">############################################################################</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">429</span>         <span style="color: #f8f8f2">Matrix</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ProblemMatrix</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">copy()</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">430</span>         <span style="color: #f8f8f2">rows,</span> <span style="color: #f8f8f2">cols</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Matrix</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">shape</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">431</span>         <span style="color: #f8f8f2">r</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">432</span>         <span style="color: #f8f8f2">pivots_pos</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">433</span>         <span style="color: #f8f8f2">row_exchanges</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">arange(rows)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">434</span>         <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">c</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(cols):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">435</span>             <span style="color: #75715e">## Find the pivot row:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">436</span>             <span style="color: #f8f8f2">pivot</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">argmax</span> <span style="color: #f8f8f2">(np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">abs</span> <span style="color: #f8f8f2">(Matrix[r:rows,c]))</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">r</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">437</span>             <span style="color: #f8f8f2">m</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">abs(Matrix[pivot,</span> <span style="color: #f8f8f2">c])</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">438</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">m</span> <span style="color: #f92672">&lt;=</span> <span style="color: #f8f8f2">THRESHOLD:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">439</span>                 <span style="color: #75715e">## Skip column c, making sure the approximately zero terms are actually zero.</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">440</span>                 <span style="color: #f8f8f2">Matrix[r:rows,</span> <span style="color: #f8f8f2">c]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">zeros(rows</span><span style="color: #f92672">-</span><span style="color: #f8f8f2">r)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">441</span>             <span style="color: #66d9ef">else</span><span style="color: #f8f8f2">:</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">442</span>                 <span style="color: #75715e">## keep track of bound variables</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">443</span>                 <span style="color: #f8f8f2">pivots_pos</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">append((r,c))</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">444</span> 
<span style="background-color: #272822; padding: 0 5px 0 5px">445</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">pivot</span> <span style="color: #f92672">!=</span> <span style="color: #f8f8f2">r:</span> <span style="color: #75715e">## Swap current row and pivot row</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">446</span>                     <span style="color: #f8f8f2">Matrix[[pivot,</span> <span style="color: #f8f8f2">r],</span> <span style="color: #f8f8f2">c:cols]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Matrix[[r,</span> <span style="color: #f8f8f2">pivot],</span> <span style="color: #f8f8f2">c:cols]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">447</span>                     <span style="color: #f8f8f2">row_exchanges[[pivot,r]]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">row_exchanges[[r,pivot]]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">448</span>                     
<span style="background-color: #272822; padding: 0 5px 0 5px">449</span>                 <span style="color: #75715e">## Normalize pivot row</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">450</span>                 <span style="color: #f8f8f2">Matrix[r,</span> <span style="color: #f8f8f2">c:cols]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Matrix[r,</span> <span style="color: #f8f8f2">c:cols]</span> <span style="color: #f92672">/</span> <span style="color: #f8f8f2">Matrix[r,</span> <span style="color: #f8f8f2">c];</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">451</span>                 <span style="color: #75715e">## Eliminate the current column</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">452</span>                 <span style="color: #f8f8f2">v</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Matrix[r,</span> <span style="color: #f8f8f2">c:cols]</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">453</span>                 
<span style="background-color: #272822; padding: 0 5px 0 5px">454</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">r</span> <span style="color: #f92672">&gt;</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">:</span> <span style="color: #75715e">## Above (before row r):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">455</span>                     <span style="color: #f8f8f2">ridx_above</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">arange(r)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">456</span>                     <span style="color: #f8f8f2">Matrix[ridx_above,</span> <span style="color: #f8f8f2">c:cols]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Matrix[ridx_above,</span> <span style="color: #f8f8f2">c:cols]</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">outer(v,</span> <span style="color: #f8f8f2">Matrix[ridx_above,</span> <span style="color: #f8f8f2">c])</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">T</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">457</span>                 <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">r</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">rows</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">:</span> <span style="color: #75715e">## Below (after row r):</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">458</span>                     <span style="color: #f8f8f2">ridx_below</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">arange(r</span><span style="color: #f92672">+</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">,rows)</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">459</span>                     <span style="color: #f8f8f2">Matrix[ridx_below,</span> <span style="color: #f8f8f2">c:cols]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Matrix[ridx_below,</span> <span style="color: #f8f8f2">c:cols]</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">np</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">outer(v,</span> <span style="color: #f8f8f2">Matrix[ridx_below,</span> <span style="color: #f8f8f2">c])</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">T</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">460</span>                 <span style="color: #f8f8f2">r</span> <span style="color: #f92672">+=</span> <span style="color: #ae81ff">1</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">461</span>             <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">r</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">rows:</span> <span style="color: #75715e">## Check if done</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">462</span>                 <span style="color: #66d9ef">break</span><span style="color: #f8f8f2">;</span>
<span style="background-color: #272822; padding: 0 5px 0 5px">463</span>         <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">(Matrix,</span> <span style="color: #f8f8f2">row_exchanges)</span>
</pre></div>
</body>
</html>
